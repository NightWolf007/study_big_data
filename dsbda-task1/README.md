# Task 1

## Условия задачи

* Входные данные — текстовые файлы логов HTTP-запросов
* Выходные данные — SequenceFile с snappy-сжатием

### Дополнительные условия

* Writable должны переиспользоваться

### Содержимое отчёта

* Исходный код
* Скриншот результатов unit-тестирования
* Скриншот загрузки файлов в HDFS
* Скриншот запущенной задачи и результата
* Скриншот чтения сжатого файла
* Инструкция по развёртыванию системы
* Скриншот с информацией о потреблении памяти

## Развёртывание системы

### Требования

* Linux-based операционная система
* Установленные пакеты `docker` и `docker-compose`
* Установленные пакеты `jdk8` и `sbt`

### Конфигурация и запуск кластера

Для создания Hadoop-кластера использован готовый образ Docker из репозитория `kiwenlau/hadoop`.
Данный образ модифицирован для работы с Java 8 и snappy-сжатием, для сборки образа необходимо
в директории `environment` выполнить команду `./build.sh`.

Конфигурация кластера производится командой `./configure.sh`, которая принимает на вход число
data node, например, `./configure.sh 2`. После выполнения данной команды в директории `environment`
будет создан файл `docker-compose.yml` с описанием конфигурации системы.

Для запуска системы необходимо выполнить команду `docker-compose up` с правами суперпользователя.

Остановка система производится аналогичной командой `docker-compose down`.

### Сборка проекта

Для сборки проекта необходимо ввести команду `sbt assembly` в директории `mapreduce`.
В ходе сборки будут загружены необходимые зависимости, выполнены unit-тесты, а также собран
`jar`-файл для исполнения в Hadoop.

[Результат unit-тестов.](screenshots/tests.png)

### Запуск задачи

Для создания входных данных и запуска задачи используется скрипт `./run.sh`
в директории `environment`. При выполнении данного скрипта будут сгенерированы файлы с логами
и загружены в HDFS.

[Загруженные входные данные.](screenshots/input.png)

Во время выполнения скрипта будет также загружен и исполнен `jar`-файл, который должен быть
предварительно собран по инструкции выше.

[Ход выполнения задачи и информация о потреблении ресурсов.](screenshots/job.png)

После выполнения задачи скрипт выведет на экран выходные данных, предварительно произведя
их распаковку и преобразование в текст.

[Выходные данные в текстовом виде.](screenshots/output.png)

Для повторного запуска задачи без генерации входных данных можно использовать команду
`./run.sh --no-gen`.
